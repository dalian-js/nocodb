version: "3.5"

services:
  db80:
     network_mode: host
     image: mysql:8.0
     restart: always
     environment:
       MYSQL_ROOT_PASSWORD: password
     volumes:
       - ./packages/nocodb/tests/mysql-sakila-db:/docker-entrypoint-initdb.d
  xc-cypress-nocodb:
    network_mode: host
    image: node:14-alpine
    volumes:
      - ./packages/nocodb:/home/app
    command:
      - /bin/sh
      - -c
      - |
        echo "~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"
        rm /home/app/package-lock.json
        cd /home/app/ && npm i && npm run run
  xc-cypress-nc-gui:
    network_mode: host
    image: node:14-alpine
    environment:
      - HOST=0.0.0.0
      - PORT=3000
    volumes:
      - ./packages/nc-gui:/home/app
      - ./packages/nc-lib-gui:/home/nc-lib-gui
    command:
      - /bin/sh
      - -c
      - |
        echo "~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"
        apk --update --no-cache add git
        rm /home/app/package-lock.json
        cd /home/app/ && npm i && npm run dev
